{% extends "base.html" %}

{% block title %}Welcome to StudySitare{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
<style>
.hero-section {
    background: linear-gradient(135deg, #6f42c1, #007bff);
    color: white;
    padding: 100px 0;
    margin-top: -1.5rem;
}

.feature-card {
    transition: transform 0.3s ease;
    border: none;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.feature-card:hover {
    transform: translateY(-10px);
}

.feature-icon {
    height: 80px;
    width: 80px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: rgba(13, 110, 253, 0.1);
}

.step-card {
    background: white;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    height: 100%;
    transition: transform 0.3s ease;
}

.step-card:hover {
    transform: translateY(-5px);
}

.step-number {
    width: 40px;
    height: 40px;
    background: #007bff;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto;
    font-size: 1.2rem;
    font-weight: bold;
}

.team-card {
    border: none;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s ease;
}

.team-card:hover {
    transform: translateY(-5px);
}

.contact-card {
    border: none;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Smooth Scroll */
html {
    scroll-behavior: smooth;
}

/* Navbar Animation */
.navbar {
    transition: background-color 0.3s ease;
}

.navbar.scrolled {
    background-color: rgba(13, 110, 253, 0.95) !important;
    backdrop-filter: blur(10px);
}

/* Loading State */
.btn:disabled {
    cursor: not-allowed;
}
</style>
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section id="hero" class="hero-section text-center py-5 mb-5">
    <div class="container">
        <h1 class="display-4 mb-4 fw-bold text-primary animate__animated animate__fadeIn">Welcome to StudySitare</h1>
        <p class="lead mb-4 animate__animated animate__fadeIn animate__delay-1s">Your comprehensive learning platform for Sitare University</p>
        {% if not current_user.is_authenticated %}
            <div class="d-flex justify-content-center gap-3 animate__animated animate__fadeInUp animate__delay-2s">
                <a href="{{ url_for('student_login') }}" class="btn btn-primary btn-lg">
                    <i class="fas fa-user-graduate me-2"></i>Student Login
                </a>
                <a href="{{ url_for('admin_login') }}" class="btn btn-outline-primary btn-lg">
                    <i class="fas fa-user-shield me-2"></i>Admin Login
                </a>
            </div>
        {% endif %}
    </div>
</section>

<!-- Features Section -->
<section id="features" class="container mb-5">
    <div class="row g-4">
        <div class="col-md-4">
            <div class="card h-100 feature-card" data-aos="fade-up">
                <div class="card-body text-center">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-book-open fa-3x text-primary"></i>
                    </div>
                    <h3 class="card-title h4">Study Materials</h3>
                    <p class="card-text">Access comprehensive study materials for all semesters, including lecture notes, presentations, and practice problems.</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card h-100 feature-card" data-aos="fade-up" data-aos-delay="100">
                <div class="card-body text-center">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-video fa-3x text-primary"></i>
                    </div>
                    <h3 class="card-title h4">Video Tutorials</h3>
                    <p class="card-text">Watch curated video tutorials for each topic, helping you understand complex concepts better.</p>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card h-100 feature-card" data-aos="fade-up" data-aos-delay="200">
                <div class="card-body text-center">
                    <div class="feature-icon mb-3">
                        <i class="fas fa-road fa-3x text-primary"></i>
                    </div>
                    <h3 class="card-title h4">Learning Roadmaps</h3>
                    <p class="card-text">Follow structured learning paths designed specifically for each semester and subject.</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- How It Works Section -->
<section id="how-it-works" class="container mb-5">
    <h2 class="text-center mb-4" data-aos="fade-up">How It Works</h2>
    <div class="row g-4">
        <div class="col-md-3">
            <div class="step-card text-center p-3" data-aos="fade-right">
                <div class="step-number mb-3">1</div>
                <h4>Register</h4>
                <p>Create your student account with your university credentials</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="step-card text-center p-3" data-aos="fade-right" data-aos-delay="100">
                <div class="step-number mb-3">2</div>
                <h4>Choose Semester</h4>
                <p>Select your current semester to access relevant materials</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="step-card text-center p-3" data-aos="fade-right" data-aos-delay="200">
                <div class="step-number mb-3">3</div>
                <h4>Study</h4>
                <p>Access study materials, videos, and practice problems</p>
            </div>
        </div>
        <div class="col-md-3">
            <div class="step-card text-center p-3" data-aos="fade-right" data-aos-delay="300">
                <div class="step-number mb-3">4</div>
                <h4>Track Progress</h4>
                <p>Monitor your learning progress and achievements</p>
            </div>
        </div>
    </div>
</section>

<!-- Team Section -->
<section id="team" class="container mb-5">
    <h2 class="text-center mb-4" data-aos="fade-up">Our Team</h2>
    <div class="row g-4">
        <div class="col-md-4" data-aos="fade-up">
            <div class="team-card card h-100">
                <div class="card-img-top text-center py-4 bg-light">
                    <i class="fas fa-user-tie fa-5x text-primary"></i>
                </div>
                <div class="card-body text-center">
                    <h5 class="card-title">Dr. Sarah Johnson</h5>
                    <p class="card-text text-muted">Academic Director</p>
                </div>
            </div>
        </div>
        <div class="col-md-4" data-aos="fade-up" data-aos-delay="100">
            <div class="team-card card h-100">
                <div class="card-img-top text-center py-4 bg-light">
                    <i class="fas fa-chalkboard-teacher fa-5x text-primary"></i>
                </div>
                <div class="card-body text-center">
                    <h5 class="card-title">Prof. Michael Chen</h5>
                    <p class="card-text text-muted">Lead Mentor</p>
                </div>
            </div>
        </div>
        <div class="col-md-4" data-aos="fade-up" data-aos-delay="200">
            <div class="team-card card h-100">
                <div class="card-img-top text-center py-4 bg-light">
                    <i class="fas fa-user-graduate fa-5x text-primary"></i>
                </div>
                <div class="card-body text-center">
                    <h5 class="card-title">Dr. Emily Patel</h5>
                    <p class="card-text text-muted">Student Success Coordinator</p>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Contact Section -->
<section id="contact" class="container mb-5">
    <div class="row">
        <div class="col-md-8 mx-auto">
            <div class="card contact-card" data-aos="fade-up">
                <div class="card-body">
                    <h2 class="text-center mb-4">Get in Touch</h2>
                    <form id="contactForm" onsubmit="return handleContactSubmit(event)">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <div class="mb-3">
                            <label for="name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                            <div class="invalid-feedback">Please enter your name.</div>
                        </div>
                        <div class="mb-3">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                            <div class="invalid-feedback">Please enter a valid email address.</div>
                        </div>
                        <div class="mb-3">
                            <label for="message" class="form-label">Message</label>
                            <textarea class="form-control" id="message" name="message" rows="4" required></textarea>
                            <div class="invalid-feedback">Please enter your message.</div>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary" id="submitBtn">
                                <span class="spinner-border spinner-border-sm d-none me-2" role="status" aria-hidden="true"></span>
                                Send Message
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
<script>
    // Initialize AOS
    AOS.init({
        duration: 800,
        once: true,
        offset: 100
    });

    // Navbar scroll effect
    window.addEventListener('scroll', function() {
        const navbar = document.querySelector('.navbar');
        if (window.scrollY > 50) {
            navbar.classList.add('scrolled');
        } else {
            navbar.classList.remove('scrolled');
        }
    });

    // Contact form handling
    async function handleContactSubmit(event) {
        event.preventDefault();
        
        const form = event.target;
        const submitBtn = form.querySelector('#submitBtn');
        const spinner = submitBtn.querySelector('.spinner-border');
        
        // Validate form
        if (!form.checkValidity()) {
            form.classList.add('was-validated');
            return false;
        }
        
        // Disable button and show spinner
        submitBtn.disabled = true;
        spinner.classList.remove('d-none');
        
        try {
            const formData = new FormData(form);
            const response = await fetch('/contact', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-CSRFToken': formData.get('csrf_token')
                }
            });
            
            const result = await response.json();
            
            if (response.ok) {
                // Show success message
                form.reset();
                form.classList.remove('was-validated');
                showAlert('success', result.message);
            } else {
                throw new Error(result.message || 'An error occurred');
            }
        } catch (error) {
            showAlert('error', error.message);
        } finally {
            // Re-enable button and hide spinner
            submitBtn.disabled = false;
            spinner.classList.add('d-none');
        }
        
        return false;
    }

    // Alert helper function
    function showAlert(type, message) {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type === 'error' ? 'danger' : 'success'} alert-dismissible fade show`;
        alertDiv.innerHTML = `
            <i class="fas fa-${type === 'error' ? 'exclamation-circle' : 'check-circle'} me-2"></i>
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;
        
        const container = document.querySelector('#contact .card-body');
        container.insertBefore(alertDiv, container.firstChild);
        
        // Auto dismiss after 5 seconds
        setTimeout(() => {
            alertDiv.classList.remove('show');
            setTimeout(() => alertDiv.remove(), 150);
        }, 5000);
    }

    // Intersection Observer for navbar links
    const sections = document.querySelectorAll('section[id]');
    const navLinks = document.querySelectorAll('.navbar-nav .nav-link[href^="#"]');

    const observerOptions = {
        rootMargin: '-20% 0px -80% 0px'
    };

    const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    if (link.getAttribute('href').substring(1) === entry.target.id) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });
            }
        });
    }, observerOptions);

    sections.forEach(section => observer.observe(section));
</script>
{% endblock %}
